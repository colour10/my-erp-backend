webpackJsonp([12],{327:function(e,t,i){"use strict";function l(e){i(519)}Object.defineProperty(t,"__esModule",{value:!0});var a=i(435),o=i(523),n=i(0),s=l,r=n(a.a,o.a,!1,s,"data-v-785cdd4b",null);t.default=r.exports},377:function(e,t,i){var l=i(378);"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);i(56)("3cc9f1f6",l,!0,{})},378:function(e,t,i){t=e.exports=i(55)(!1),t.push([e.i,".el-table--striped .el-table__body tr.el-table__row--striped td,.el-table .el-table__row--striped{background-color:oldlace}",""])},435:function(e,t,i){"use strict";var l=i(12),a=i.n(l),o=i(9),n=i.n(o),s=i(13),r=i.n(s),c=i(2),d=i(377),u=(i.n(d),i(521)),p=(i.n(u),i(197)),h=i(142),f=i(2),m=i(23);t.a={name:"product",components:{AsaProduct:h.a,add:p.a},data:function(){return{host:m.a,importExcelPath:"",dialogFormVisible:!1,importDialogVisible:!1,listLoading:!0,list:[],listQuery:{wordcode:"",ageseason:[],brandid:[],brandgroupid:[],childbrand:[],series:[]},childrenBrand:[],pagination:{pageSizes:c.f.pageSizes,pageSize:10,total:0,current:1},ageseasons:[],brands:[],categories:[],productMemos:[],series:[]}},created:function(){this.getList(),this.getProductRelatedOptions()},methods:{onClick:function(e){var t=this;return r()(n.a.mark(function i(){var l,a,o;return n.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return l=t,a=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"}),i.next=4,l.$refs.product.edit(!0).setInfo(e).then(function(e){return e.show(!1)});case 4:o=i.sent,!0===o&&a.close();case 6:case"end":return i.stop()}},i,t)}))()},getProductRelatedOptions:function(){var e=this;e._fetch("/product/getProductRelatedOptions",{}).then(function(t){e.ageseasons=t.data.ageseasons,e.brands=t.data.brands,e.categories=t.data.categories,e.productMemos=t.data.productMemos})},handleSort:function(e){this.listQuery.sort=e.prop,this.listQuery.order=e.order,this.getList()},handleDelete:function(e){var t=this;t._remove("/product/delete",{id:e.id}).then(function(){t.reloadList()})},handleResetFilter:function(){this.listQuery={sort:void 0,order:void 0,wordcode:"",ageseason:[],brandid:[],brandgroupid:[],childbrand:[],series:[]}},handleChangeBrand:function(){var e=this;e.series=[],e.listQuery.series=[],e.listQuery.brandid.length>0?e.brands.forEach(function(t){e.listQuery.brandid.indexOf(t.id)>=0&&e.series.push.apply(e.series,t.series)}):e.brands.forEach(function(t){e.series.push.apply(e.series,t.series)})},handleChangeBrandGroup:function(){var e=this;e.listQuery.childbrand=[],e.childrenBrand=[],e.categories.forEach(function(t){e.listQuery.brandgroupid.indexOf(t.id)>=0&&e.childrenBrand.push.apply(e.childrenBrand,t.children)})},handleFilter:function(){this.getList()},handleCreate:function(){this.showDialogForm(),void 0!==this.$refs.productForm&&this.$refs.productForm.resetDialogForm()},handleImport:function(){this.showImportDialogForm()},handleSizeChange:function(e){this.pagination.pageSize=e,this.getList()},handleCurrentChange:function(e){this.pagination.current=e,this.getList()},showDialogForm:function(){this.dialogFormVisible=!0},hideDialogForm:function(){this.dialogFormVisible=!1},showImportDialogForm:function(){this.importDialogVisible=!0},hideImportDialogForm:function(){this.importDialogVisible=!1},getList:function(){var e=this;e.listLoading=!0;var t=a()({page:e.pagination.current,pageSize:e.pagination.pageSize},e.listQuery);e._fetch("/product/page",t).then(function(t){e.list=t.data,e.pagination=t.pagination,e.listLoading=!1})},reloadList:function(){this.getList()},handleExcelSuccess:function(e,t){var i=this;console.log("res=",e,"file=",t);var l=t.raw.name;this.importExcelPath=e.files[l];var a=this.$loading({lock:!0,text:Object(f.d)("results-preview-loading"),spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"});this._fetch("/common/importExcelPreview",{path:this.importExcelPath}).then(function(e){a.close(),0===e.messages.length?i.$alert(e.data,Object(f.d)("results-preview"),{}):i.$alert(e.messages[0],Object(f.d)("results-preview"),{})})},handleExcelRemove:function(e,t){var i=this;console.log(e,t),this._fetch("/common/delete",{path:this.importExcelPath}).then(function(e){console.log("res = ",e),i.importExcelPath=""})},beforeExcelRemove:function(e,t){return this.$confirm(Object(f.d)("handle-delete")+" "+e.name+"?")},handleExcelExceed:function(e,t){console.log("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件"),this.$message.warning(Object(f.d)("upload-warning"))},beforeExcelUpload:function(e){var t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type,i=e.size/1024/1024<2;return t||this.$message.error(Object(f.d)("upload-filetype")),i||this.$message.error(Object(f.d)("upload-filesize-2mb")),t&&i},handleFinishedImportDialog:function(){var e=this;if(""===this.importExcelPath)return void this.hideImportDialogForm();var t=this.$loading({lock:!0,text:Object(f.d)("results-finish-loading"),spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"});this._fetch("/common/importExcel",{path:this.importExcelPath}).then(function(i){console.log("res = ",i),t.close(),0===i.messages.length?(e.$alert(Object(f.d)("results-finished"),Object(f.d)("results-preview"),{}),e.importExcelPath=""):e.$alert(i.messages[0],Object(f.d)("results-preview"),{})})},handleExcelDownload:function(){window.open(m.a+"/upload/excel/example.xlsx")}}}},519:function(e,t,i){var l=i(520);"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);i(56)("2b3dfa05",l,!0,{})},520:function(e,t,i){t=e.exports=i(55)(!1),t.push([e.i,".create-product-dialog .el-dialog__header[data-v-785cdd4b]{border-bottom:1px solid #d3d3d3}.upload-demo[data-v-785cdd4b]{text-align:center}",""])},521:function(e,t,i){var l=i(522);"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);i(56)("61953436",l,!0,{})},522:function(e,t,i){t=e.exports=i(55)(!1),t.push([e.i,".filter-container .el-button{margin:0}",""])},523:function(e,t,i){"use strict";var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"filter-container"},[i("el-form",{ref:"searchForm",attrs:{inline:!0,model:e.listQuery,size:"mini"}},[i("el-form-item",{attrs:{label:e.showLabel("guojima")}},[i("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.wordcode,callback:function(t){e.$set(e.listQuery,"wordcode",t)},expression:"listQuery.wordcode"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.showLabel("niandai")}},[i("el-select",{attrs:{multiple:"",placeholder:""},model:{value:e.listQuery.ageseason,callback:function(t){e.$set(e.listQuery,"ageseason",t)},expression:"listQuery.ageseason"}},e._l(e.ageseasons,function(e){return i("el-option",{key:e.id+e.title,attrs:{label:e.title,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:e.showLabel("pinpai")}},[i("el-select",{attrs:{multiple:"",placeholder:""},on:{change:e.handleChangeBrand},model:{value:e.listQuery.brandid,callback:function(t){e.$set(e.listQuery,"brandid",t)},expression:"listQuery.brandid"}},e._l(e.brands,function(e){return i("el-option",{key:e.id+e.title,attrs:{label:e.title,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:e.showLabel("pinlei")}},[i("el-select",{attrs:{filterable:"",placeholder:""},on:{change:e.handleChangeBrandGroup},model:{value:e.listQuery.brandgroupid,callback:function(t){e.$set(e.listQuery,"brandgroupid",t)},expression:"listQuery.brandgroupid"}},e._l(e.categories,function(e){return i("el-option",{key:e.id+e.title,attrs:{label:e.title,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:e.showLabel("zipinlei")}},[i("el-select",{attrs:{filterable:"",placeholder:""},model:{value:e.listQuery.childbrand,callback:function(t){e.$set(e.listQuery,"childbrand",t)},expression:"listQuery.childbrand"}},e._l(e.childrenBrand,function(e){return i("el-option",{key:e.id+e.title,attrs:{label:e.title,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:e.showLabel("shangpinmiaoshu")}},[i("el-select",{attrs:{multiple:"",placeholder:""},model:{value:e.listQuery.productmemoids,callback:function(t){e.$set(e.listQuery,"productmemoids",t)},expression:"listQuery.productmemoids"}},e._l(e.productMemos,function(e){return i("el-option",{key:e.id+e.title,attrs:{label:e.title,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:e.showLabel("shangpinxilie")}},[i("el-select",{attrs:{multiple:"",placeholder:""},model:{value:e.listQuery.series,callback:function(t){e.$set(e.listQuery,"series",t)},expression:"listQuery.series"}},e._l(e.series,function(e){return i("el-option",{key:e.id+e.title,attrs:{label:e.title,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",[i("el-button",{staticClass:"filter-item",attrs:{type:"default",size:"mini",icon:"el-icon-refresh-right"},on:{click:e.handleResetFilter}},[e._v("\n          "+e._s(e.showLabel("qingkong"))+"\n        ")])],1),e._v(" "),i("el-form-item",[i("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"mini",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("\n          "+e._s(e.showLabel("search"))+"\n        ")])],1),e._v(" "),i("el-form-item",[i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"success",size:"mini",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("\n          "+e._s(e.showLabel("button-create"))+"\n        ")])],1),e._v(" "),i("el-form-item",[i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"warning",size:"mini",icon:"el-icon-star-off"},on:{click:e.handleImport}},[e._v("\n          "+e._s(e.showLabel("button-export"))+"\n        ")])],1),e._v(" "),i("el-form-item",[i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",size:"mini",icon:"el-icon-star-off"},on:{click:e.handleExcelDownload}},[e._v("\n          "+e._s(e.showLabel("excel-download"))+"\n        ")])],1)],1)],1),e._v(" "),i("el-row",{staticClass:"product",attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,border:"",stripe:""},on:{"sort-change":e.handleSort}},[i("el-table-column",{attrs:{label:e.showLabel("caozuo"),align:"center",width:"150","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[i("el-button",{attrs:{type:"default",size:"mini"},on:{click:function(t){return e.onClick(l)}}},[e._v(e._s(e.showLabel("bianji")))]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.handleDelete(l)}}},[e._v(e._s(e.showLabel("shanchu")))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("zhutu")},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[i("img",{staticStyle:{"max-width":"50px","max-height":"50px"},attrs:{src:e._fileLink(l.picture_150)}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("futu")},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[i("img",{staticStyle:{"max-width":"50px","max-height":"50px"},attrs:{src:e._fileLink(l.picture2_150)}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("yanse")},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return e._l(l.colors,function(t){return i("div",{key:t.id,staticClass:"color-group"},[i("div",{staticClass:"box",staticStyle:{"'width":"20px",height:"20px"}},[i("img",{staticStyle:{"max-width":"20px","max-height":"20px"},attrs:{src:e._fileLink(t.picture_40)},on:{click:function(t){return e.onClick(l)}}})])])})}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("shangpinmingcheng"),width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.name)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("niandai"),sortable:"customer",prop:"ageseason"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.season)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("guojima"),width:"200",sortable:"customer",prop:"wordcode"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.wordcode)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("shangpinshuxing")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.type)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("chuchangjia"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.fpCurrencyCode)+" "+e._s(i.factoryprice)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("beilv")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.times)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("guojilingshoujia"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.wpCurrencyCode)+" "+e._s(i.wordprice)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("zhekoulv")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.discountRate)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("benguolingshoujia"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.npCurrencyCode)+" "+e._s(i.nationalprice)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("xiaoshoushuxing")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.saleType)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("lingshoubi")}},[e._v("\n          0\n        ")]),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("xilie")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.seriesTitle)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.showLabel("zuihouruku")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.laststoragedate)+"\n          ")]}}])})],1)],1)],1),e._v(" "),e.list.length<e.pagination.total?i("el-pagination",{attrs:{"current-page":1*e.pagination.current,"page-sizes":e.pagination.pageSizes,"page-size":1*e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:1*e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),e._v(" "),i("el-dialog",{attrs:{title:e.showLabel("createProduct"),visible:e.dialogFormVisible,center:!0,width:"1400px","close-on-click-modal":!1,"close-on-press-escape":!1,"custom-class":"create-product-dialog"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("add",{ref:"productForm",on:{hideDialogForm:e.hideDialogForm,reloadList:e.reloadList}})],1),e._v(" "),i("asa-product",{ref:"product",on:{reloadList:e.reloadList}}),e._v(" "),i("el-dialog",{attrs:{title:e._label("button-export"),visible:e.importDialogVisible,width:"30%"},on:{"update:visible":function(t){e.importDialogVisible=t}}},[i("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:e.host+"/common/upload?category=excel",limit:1,"on-remove":e.handleExcelRemove,"before-remove":e.beforeExcelRemove,"on-exceed":e.handleExcelExceed,"on-success":e.handleExcelSuccess,"before-upload":e.beforeExcelUpload}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v(e._s(e._label("upload-text"))),i("em",[e._v(e._s(e._label("upload-click-text")))])]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e._label("upload-tip")))])]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:e.hideImportDialogForm}},[e._v(e._s(e._label("quxiao")))]),e._v(" "),""!==e.importExcelPath?i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击确定按钮完成操作",placement:"top-start"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleFinishedImportDialog}},[e._v(e._s(e._label("queding")))])],1):i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleFinishedImportDialog}},[e._v(e._s(e._label("queding")))])],1)],1)],1)},a=[],o={render:l,staticRenderFns:a};t.a=o}});